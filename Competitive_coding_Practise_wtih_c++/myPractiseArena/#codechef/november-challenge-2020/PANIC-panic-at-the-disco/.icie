{"task_url":"https://www.codechef.com/NOV20B/problems/PANIC","statement":{"HTML":{"html":"\n<html>\n\t<head>\n\t\t<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/3.0.1/github-markdown.min.css\">\n\t\t<script type=\"text/x-mathjax-config\">\n\t\t\tMathJax.Hub.Config({\n\t\t\t\ttex2jax: {inlineMath: [['$','$']]}\n\t\t\t});\n\t\t</script>\n\t\t<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>\n\t\t<style>\n\t\t\t.markdown-body {\n\t\t\t\tbackground-color: white;\n\t\t\t\tpadding-bottom: 20px;\n\t\t\t}\n\t\t\t.markdown-body code {\n\t\t\t\tcolor: #24292e;\n\t\t\t}\n\t\t\t.solution-visible-txt {\n\t\t\t\tdisplay: none;\n\t\t\t}\n\t\t</style>\n\t</head>\n\t<body class=\"markdown-body\">\n\t\t<h1>Panic! at the Disco</h1>\n<h3>Read problem statements in <a href=\"http://www.codechef.com/download/translated/NOV20/hindi/PANIC.pdf\">Hindi</a>, <a href=\"http://www.codechef.com/download/translated/NOV20/bengali/PANIC.pdf\">Bengali</a>, <a href=\"http://www.codechef.com/download/translated/NOV20/mandarin/PANIC.pdf\">Mandarin Chinese</a>,<a href=\"http://www.codechef.com/download/translated/NOV20/russian/PANIC.pdf\">Russian</a>, and <a href=\"http://www.codechef.com/download/translated/NOV20/vietnamese/PANIC.pdf\">Vietnamese</a> as well.</h3>\n<p>You are given a $K \\times K$ matrix $M$. For each $r$ and $c$ ($1 \\le r, c \\le K$), let's denote the element in the $r$-th row and $c$-th column by $M_{r, c}$. You are also given three integers $N$, $a$ and $d$. Let's define a $K \\times K$ matrix\n$$S = \\sum_{i=0}^N F_{a + i \\cdot d} \\cdot M^i ,.$$\nHere, $M^0$ is the identity matrix and for any non-negative integer $i$, $F_i$ is the $i$-th Fibonacci number â€• formally, $F_0 = 0$, $F_1 = 1$ and $F_i = F_{i-1} + F_{i-2}$ for $i \\gt 1$.</p>\n<p>Let's denote elements of the matrix $S$ in the same way as for $M$. For each valid $r$ and $c$, compute $S_{r, c}$ modulo $998,244,353$.</p>\n<h3>Input</h3>\n<ul>\n<li>The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.</li>\n<li>The first line of each test case contains four space-separated integers $K$, $a$, $d$ and $N$.</li>\n<li>$K$ lines follow. For each valid $i$, the $i$-th of these lines contains $K$ space-separated integers $M_{i, 1}, M_{i, 2}, \\ldots, M_{i, K}$.</li>\n</ul>\n<h3>Output</h3>\n<p>For each test case, print $K$ lines. For each valid $i$, the $i$-th of these lines should contain $K$ space-separated integers $S_{i, 1}, S_{i, 2}, \\ldots, S_{i, K}$ modulo $998,244,353$.</p>\n<h3>Constraints</h3>\n<ul>\n<li>$1 \\le T \\le 100$</li>\n<li>$1 \\le K \\le 100$</li>\n<li>$0 \\le a, d \\le 10^9$</li>\n<li>$0 \\le N \\le 10^{1,000}$</li>\n<li>$0 \\le M_{i, j} \\lt 998,244,353$ for each valid $i$ and $j$</li>\n<li>the sum of $K$ over all test cases does not exceed $100$</li>\n</ul>\n<h3>Subtasks</h3>\n<p><strong>Subtask #1 (10 points):</strong></p>\n<ul>\n<li>$K = 1$</li>\n<li>$N \\le 10^{18}$</li>\n</ul>\n<p><strong>Subtask #2 (30 points):</strong></p>\n<ul>\n<li>$K \\le 20$</li>\n<li>$N \\le 10^{18}$</li>\n</ul>\n<p><strong>Subtask #3 (60 points):</strong> original constraints</p>\n<h3>Example Input</h3>\n<pre><code>3\n1 0 2 4\n1\n2 3 4 5\n1 0\n0 1\n3 23 45 107\n5 7 2\n1 8 9\n3 4 5\n</code></pre>\n<h3>Example Output</h3>\n<pre><code>33\n33552 0\n0 33552\n601338635 934201293 356700741\n960409891 125261415 197093893\n136328022 287118456 122438416\n</code></pre>\n\n\t<body>\n</html>"}}}