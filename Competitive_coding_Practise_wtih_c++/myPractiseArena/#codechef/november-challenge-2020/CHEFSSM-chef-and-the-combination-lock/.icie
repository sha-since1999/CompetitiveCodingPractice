{"task_url":"https://www.codechef.com/NOV20B/problems/CHEFSSM","statement":{"HTML":{"html":"\n<html>\n\t<head>\n\t\t<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/3.0.1/github-markdown.min.css\">\n\t\t<script type=\"text/x-mathjax-config\">\n\t\t\tMathJax.Hub.Config({\n\t\t\t\ttex2jax: {inlineMath: [['$','$']]}\n\t\t\t});\n\t\t</script>\n\t\t<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>\n\t\t<style>\n\t\t\t.markdown-body {\n\t\t\t\tbackground-color: white;\n\t\t\t\tpadding-bottom: 20px;\n\t\t\t}\n\t\t\t.markdown-body code {\n\t\t\t\tcolor: #24292e;\n\t\t\t}\n\t\t\t.solution-visible-txt {\n\t\t\t\tdisplay: none;\n\t\t\t}\n\t\t</style>\n\t</head>\n\t<body class=\"markdown-body\">\n\t\t<h1>Chef and the Combination Lock</h1>\n<h3>Read problem statements in <a href=\"http://www.codechef.com/download/translated/NOV20/hindi/CHEFSSM.pdf\">Hindi</a>, <a href=\"http://www.codechef.com/download/translated/NOV20/bengali/CHEFSSM.pdf\">Bengali</a>, <a href=\"http://www.codechef.com/download/translated/NOV20/mandarin/CHEFSSM.pdf\">Mandarin Chinese</a>, <a href=\"http://www.codechef.com/download/translated/NOV20/russian/CHEFSSM.pdf\">Russian</a>, and <a href=\"http://www.codechef.com/download/translated/NOV20/vietnamese/CHEFSSM.pdf\">Vietnamese</a> as well.</h3>\n<p>Chef has a combination lock with $N$ wheels (numbered $1$ through $N$). For each valid $i$, on the $i$-th wheel, the integers from $0$ to $A_i$ (inclusive) are written in ascending order ($0$ and $A_i$ are also adjacent). Initially, one value on each wheel is selected uniformly randomly and independently.</p>\n<p>The lock operates in a very peculiar way: it opens when there is at least one wheel where either $0$ or the largest value on that wheel is selected. Chef wants to open the lock using the smallest possible number of operations; in one operation, he may choose one wheel and rotate it clockwise or counterclockwise by $1$ unit (i.e. select a value that is adjacent to the previously selected value on that wheel).</p>\n<p>Find the <a href=\"https://en.wikipedia.org/wiki/Expected_value\">expected value</a> of the number of operations which Chef needs to perform to open the lock.</p>\n<p>The expected number of operations can be represented as a fraction $\\frac{P}{Q}$, where $P$ is a non-negative integer and $Q$ a positive integer coprime with $998,244,353$. You should calculate $P \\cdot Q^{-1}$ modulo $998,244,353$, where $Q^{-1}$ denotes the multiplicative inverse of $Q$ modulo $998,244,353$.</p>\n<h3>Input</h3>\n<ul>\n<li>The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.</li>\n<li>The first line of each test case contains a single integer $N$.</li>\n<li>The second line contains $N$ space-separated integers $A_1, A_2, \\ldots, A_N$.</li>\n</ul>\n<h3>Output</h3>\n<p>For each test case, print a single line containing one integer $P \\cdot Q^{-1}$ modulo $998,244,353$.</p>\n<h3>Constraints</h3>\n<ul>\n<li>$1 \\le T \\le 10^3$</li>\n<li>$1 \\le N \\le 10^5$</li>\n<li>$0 \\le A_i \\lt 998,244,352$ for each valid $i$</li>\n<li>the sum of $N$ over all test cases does not exceed $10^5$</li>\n</ul>\n<h3>Subtasks</h3>\n<p><strong>Subtask #1 (10 points):</strong></p>\n<ul>\n<li>$N \\le 5,000$</li>\n<li>$A_i \\le 5,000$ for each valid $i$</li>\n<li>the sum of $N$ over all test cases does not exceed $5,000$</li>\n</ul>\n<p><strong>Subtask #2 (20 points):</strong></p>\n<ul>\n<li>$N \\le 5,000$</li>\n<li>the sum of $N$ over all test cases does not exceed $5,000$</li>\n</ul>\n<p><strong>Subtask #3 (70 points):</strong> original constraints</p>\n<h3>Example Input</h3>\n<pre><code>3\n2\n2 2\n2\n5 5\n3\n3 4 5\n</code></pre>\n<h3>Example Output</h3>\n<pre><code>443664157\n221832079\n598946612\n</code></pre>\n\n\t<body>\n</html>"}}}