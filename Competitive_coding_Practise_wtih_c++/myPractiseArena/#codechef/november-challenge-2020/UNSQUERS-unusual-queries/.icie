{"task_url":"https://www.codechef.com/NOV20B/problems/UNSQUERS","statement":{"HTML":{"html":"\n<html>\n\t<head>\n\t\t<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/3.0.1/github-markdown.min.css\">\n\t\t<script type=\"text/x-mathjax-config\">\n\t\t\tMathJax.Hub.Config({\n\t\t\t\ttex2jax: {inlineMath: [['$','$']]}\n\t\t\t});\n\t\t</script>\n\t\t<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>\n\t\t<style>\n\t\t\t.markdown-body {\n\t\t\t\tbackground-color: white;\n\t\t\t\tpadding-bottom: 20px;\n\t\t\t}\n\t\t\t.markdown-body code {\n\t\t\t\tcolor: #24292e;\n\t\t\t}\n\t\t\t.solution-visible-txt {\n\t\t\t\tdisplay: none;\n\t\t\t}\n\t\t</style>\n\t</head>\n\t<body class=\"markdown-body\">\n\t\t<h1>Unusual Queries</h1>\n<h3>Read problem statements in <a href=\"http://www.codechef.com/download/translated/NOV20/hindi/UNSQUERS.pdf\">Hindi</a>, <a href=\"http://www.codechef.com/download/translated/NOV20/bengali/UNSQUERS.pdf\">Bengali</a>, <a href=\"http://www.codechef.com/download/translated/NOV20/mandarin/UNSQUERS.pdf\">Mandarin Chinese</a>, <a href=\"http://www.codechef.com/download/translated/NOV20/russian/UNSQUERS.pdf\">Russian</a>, and <a href=\"http://www.codechef.com/download/translated/NOV20/vietnamese/UNSQUERS.pdf\">Vietnamese</a> as well.</h3>\n<p>There are $N$ mountains in Chefland, arranged in a line and numbered $1$ through $N$ from left to right. For each valid $i$, the $i$-th mountain from the left has a height $H_i$.</p>\n<p>Chef wants to choose a contiguous sequence of mountains $l, l+1, \\ldots, r$ and visit them in this order. He has a notebook where he writes down some heights of mountains. Initially, the notebook contains only the integer $0$ and each time he visits a new mountain whose height is strictly greater than all the integers written in the notebook so far, he writes its height in the notebook. The <em>satisfaction</em> Chef gets from travelling is the number of positive integers written in the notebook at the end. For example, if the mountains have heights $(\\underline{1}, \\underline{5}, 2, 5, 3, \\underline{7}, 2, \\underline{9})$, Chef's satisfaction is $4$ and the integers written in the notebook at the end are $0, 1, 5, 7, 9$.</p>\n<p>Your task is to answer $Q$ queries. In each query, Chef gives you two integers $L$ and $R$ ($1 \\le L \\le R \\le N$) and you should find the maximum satisfaction he can get if he can choose to visit any contiguous sequence of mountains from $l$ to $r$ such that $L \\le l \\le r \\le R$. Note that the queries are encoded in such a way that they have to be processed online.</p>\n<h3>Input</h3>\n<ul>\n<li>The first line of each test case contains three space-separated integers $N$, $Q$ and $s$.</li>\n<li>The second line contains $N$ space-separated integers $H_1, H_2, \\ldots, H_N$.</li>\n<li>Each of the following $Q$ lines contains two space-separated integers $x$ and $y$ describing a query. The parameters $L$ and $R$ for this query can be computed as follows:\n<ul>\n<li>Let $last$ be the answer to the previous query, or $0$ if this is the first query in this test case.</li>\n<li>Set $L$ to $(x + s \\cdot last - 1) ,%, N + 1$.</li>\n<li>Set $R$ to $(y + s \\cdot last - 1) ,%, N + 1$.</li>\n<li>If $L \\gt R$, swap $L$ and $R$.</li>\n</ul>\n</li>\n</ul>\n<h3>Output</h3>\n<p>For each query, print a single line containing one integer â€” the maximum satisfaction Chef can get.</p>\n<h3>Constraints</h3>\n<ul>\n<li>$1 \\le N, Q \\le 10^5$</li>\n<li>$0 \\le s \\le 1$</li>\n<li>$1 \\le H_i \\le 10^5$ for each valid $i$</li>\n<li>$1 \\le x, y \\le N$</li>\n</ul>\n<h3>Subtasks</h3>\n<p><strong>Subtask #1 (15 points):</strong> $N \\le 1,000$</p>\n<p><strong>Subtask #2 (35 points):</strong> $s=0$, i.e. the queries do not have to be processed online</p>\n<p><strong>Subtask #2 (50 points):</strong> original constraints</p>\n<h3>Example Input 1</h3>\n<pre><code>6 3 0\n4 2 3 1 5 5\n1 6\n2 4\n3 4\n</code></pre>\n<h3>Example Output 1</h3>\n<pre><code>3\n2\n1\n</code></pre>\n<h3>Explanation</h3>\n<p>In the first query, Chef can choose to visit a contiguous subsequence of mountains with heights $(4, 2, 3, 1, 5, 5)$. The subsequence that gives the maximum satisfaction is $(2, 3, 1, 5)$. In that case, Chef writes the integers $0, 2, 3, 5$ to his notebook, so the answer is $3$.</p>\n<p>In the second query, Chef can choose to visit a contiguous subsequence of mountains with heights $(2, 3, 1)$. The whole sequence has the maximum satisfaction $2$, since Chef writes the integers $0, 2, 3$.</p>\n<p>In the third query, the largest (and the only possible) satisfaction is $1$, since Chef writes either $0, 3$ or $0, 1$.</p>\n<h3>Example Input 2</h3>\n<pre><code>10 10 1\n7 8 8 9 10 10 2 3 5 10\n9 6\n2 9\n10 6\n4 2\n5 10\n4 5\n8 7\n8 2\n7 7\n9 5\n</code></pre>\n<h3>Example Output 2</h3>\n<pre><code>3\n3\n3\n1\n4\n2\n2\n4\n1\n4\n</code></pre>\n\n\t<body>\n</html>"}}}