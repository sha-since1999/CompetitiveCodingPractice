{"task_url":"https://www.codechef.com/NOV20B/problems/SELEDGE","statement":{"HTML":{"html":"\n<html>\n\t<head>\n\t\t<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/3.0.1/github-markdown.min.css\">\n\t\t<script type=\"text/x-mathjax-config\">\n\t\t\tMathJax.Hub.Config({\n\t\t\t\ttex2jax: {inlineMath: [['$','$']]}\n\t\t\t});\n\t\t</script>\n\t\t<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>\n\t\t<style>\n\t\t\t.markdown-body {\n\t\t\t\tbackground-color: white;\n\t\t\t\tpadding-bottom: 20px;\n\t\t\t}\n\t\t\t.markdown-body code {\n\t\t\t\tcolor: #24292e;\n\t\t\t}\n\t\t\t.solution-visible-txt {\n\t\t\t\tdisplay: none;\n\t\t\t}\n\t\t</style>\n\t</head>\n\t<body class=\"markdown-body\">\n\t\t<h1>Selecting Edges</h1>\n<h3>Read problem statements in <a href=\"http://www.codechef.com/download/translated/NOV20/hindi/SELEDGE.pdf\">Hindi</a>, <a href=\"http://www.codechef.com/download/translated/NOV20/bengali/SELEDGE.pdf\">Bengali</a>, <a href=\"http://www.codechef.com/download/translated/NOV20/mandarin/SELEDGE.pdf\">Mandarin Chinese</a>, <a href=\"http://www.codechef.com/download/translated/NOV20/russian/SELEDGE.pdf\">Russian</a>, and <a href=\"http://www.codechef.com/download/translated/NOV20/vietnamese/SELEDGE.pdf\">Vietnamese</a> as well.</h3>\n<p>You are given an undirected graph $G$ with $N$ vertices (numbered $1$ through $N$) and $M$ edges (numbered $1$ through $M$). $G$ does not contain any self-loops, but it may contain parallel edges. For each valid $i$, the $i$-th vertex has a non-negative integer weight $A_i$. Also, for each valid $i$, the $i$-th edge has a non-negative integer weight $B_i$.</p>\n<p>Let $E = {1, 2, \\ldots, M}$ denote the set of edges and for any subset $S \\subseteq E$, let $V(S)$ denote the set of vertices which are endpoints of at least one edge from $S$. You should find\n$$\\max\\limits_{S\\subseteq E, |S| \\le K} \\left(\\sum\\limits_{v \\in V(S)} A_v - \\sum\\limits_{e \\in S} B_e\\right) ,.$$</p>\n<p>In other words, among all subsets of at most $K$ (but possibly zero) edges, you should find the largest value of the expression &quot;sum of weights of their endpoints, where each endpoint is counted only once, minus the sum of weights of these edges&quot;. Note that $S$ may contain multiple parallel edges with the same weights ― they are still considered distinct.</p>\n<h3>Input</h3>\n<ul>\n<li>The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.</li>\n<li>The first line of each test case contains three space-separated integers $N$, $M$ and $K$.</li>\n<li>The second line contains $N$ space-separated integers $A_1, A_2, \\ldots, A_N$.</li>\n<li>$M$ lines follow. For each valid $i$, the $i$-th of these lines contains three space-separated integers $u_i$, $v_i$ and $B_i$, describing an edge between vertices $u_i$ and $v_i$ with weight $B_i$.</li>\n</ul>\n<h3>Output</h3>\n<p>For each test case, print a single line containing one integer ― the largest value of the given expression.</p>\n<h3>Constraints</h3>\n<ul>\n<li>$T = 5$</li>\n<li>$1 \\le N, M \\le 100$</li>\n<li>$1 \\le K \\le 10$</li>\n<li>$0 \\le A_i \\le 10^8$ for each valid $i$</li>\n<li>$0 \\le B_i \\le 10^8$ for each valid $i$</li>\n<li>$1 \\le u_i, v_i \\le N$ for each valid $i$</li>\n<li>$u_i \\neq v_i$ for each valid $i$</li>\n</ul>\n<h3>Subtasks</h3>\n<p><strong>Subtask #1 (5 points):</strong></p>\n<ul>\n<li>$G$ does not contain any cycles or parallel edges</li>\n<li>$K \\le 7$</li>\n</ul>\n<p><strong>Subtask #2 (15 points):</strong></p>\n<ul>\n<li>$A_i = 1$ for each valid $i$</li>\n<li>$B_i = 0$ for each valid $i$</li>\n<li>$K \\le 7$</li>\n</ul>\n<p><strong>Subtask #3 (65 points):</strong> $K \\le 9$</p>\n<p><strong>Subtask #4 (15 points):</strong> original constraints</p>\n<h3>Example Input</h3>\n<pre><code>1\n5 5 2\n1 2 4 8 16\n1 2 1\n1 3 2\n3 4 2\n4 5 2\n2 5 1\n</code></pre>\n<h3>Example Output</h3>\n<pre><code>27\n</code></pre>\n<h3>Explanation</h3>\n<p><strong>Example case 1:</strong></p>\n<p><img src=\"https://codechef_shared.s3.amazonaws.com/download/Images/NOV20/SELEDGE/SELEDGE.png\" alt=\"\" /></p>\n<p>The largest value is obtained when $S$ contains only edges $(2, 5)$ and $(3, 4)$. In that case, $V(S)$ contains the vertices $2, 3, 4, 5$.</p>\n\n\t<body>\n</html>"}}}